{% load static %}

<script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
<!-- Bootstrap JS bundle - Bootstrap + PopperJS-->
<script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- Magnific Popup - Lightbox for the gallery-->
<script src="{% static 'vendor/magnific-popup/jquery.magnific-popup.min.js' %}"></script>
<!-- Smooth scroll-->
<script src="{% static 'vendor/smooth-scroll/smooth-scroll.polyfills.min.js' %}"></script>
<!-- Bootstrap Select-->
<script src="{% static 'vendor/bootstrap-select/js/bootstrap-select.min.js' %}"></script>
<!-- Object Fit Images - Fallback for browsers that don't support object-fit-->
<script src="{% static 'vendor/object-fit-images/ofi.min.js' %}"></script>
<!-- Swiper Carousel                       -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.1/js/swiper.min.js"></script>
<script src="{% static 'js/waypoint/jquery.waypoints.min.js' %}"></script>
<script src="{% static 'js/waypoint/infinite.min.js' %}"></script>
<script src="{% static 'js/form/jquery.form.js' %}"></script>
<script async defer
            src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&key=AIzaSyD8A1j9FdYG0tGsPwf8Sa8aBOVkjHvGPws&callback=initialize&language=pl"></script>



<script>var basePath = ''</script>
<!-- Main Theme JS file    -->
<script src="{% static 'js/theme.js' %}"></script>
<!-- Map-->
<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
        integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
        crossorigin=""></script>
<!-- Available tile layers-->
<script src="{% static 'js/map-layers.js' %}"></script>
<script src="{% static 'js/map-category.js' %}"></script>
<!-- Daterange picker-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script src="{% static 'vendor/nouislider/nouislider.min.js' %}"></script>


<script>

    function injectSvgSprite(path) {

        var ajax = new XMLHttpRequest();
        ajax.open("GET", path, true);
        ajax.send();
        ajax.onload = function (e) {
            var div = document.createElement("div");
            div.className = 'd-none';
            div.innerHTML = ajax.responseText;
            document.body.insertBefore(div, document.body.childNodes[0]);
        }
    }

    injectSvgSprite('https://demo.bootstrapious.com/directory/1-4/icons/orion-svg-sprite.svg');

</script>

<script>
    var snapSlider = document.getElementById('slider-snap');

    noUiSlider.create(snapSlider, {
        start: [0, 15000],
        snap: false,
        connect: true,
        step: 100,
        range: {
            'min': 0,
            'max': 15000
        }
    });
    var snapValues = [
        document.getElementById('slider-snap-value-from'),
        document.getElementById('slider-snap-value-to')
    ];
    var inputValues = [
        document.getElementById('slider-snap-input-from'),
        document.getElementById('slider-snap-input-to')
    ];
    snapSlider.noUiSlider.on('update', function (values, handle) {
        console.log(values[handle]);
        snapValues[handle].innerHTML = Math.round(values[handle]);
        inputValues[handle].value = values[handle];
    });


    function f() {
        var infinite = new Waypoint.Infinite({
            element: $('.infinite-container')[0],
            handler: function (direction) {
            },
            offset: 'bottom-in-view',
            onBeforePageLoad: function () {
                $('.spinner-border').show();
            },
            onAfterPageLoad: function (items) {
                $('.spinner-border').hide();
                console.log(items);
            }
        });
    }

    $(document).ready(function () {
        f();
        var start = {lat: 52.219396, lng: 21.002137};
        let map = new google.maps.Map(document.getElementById('categorySideMap'), {zoom: 13, center: start});
    });



     $('#search-frm').ajaxForm({
        success: function (data) {
            $('.ajax-container').empty();
            $('.ajax-container').html($.parseHTML(data));
            f();
        }
    });


    $(document).on('change', '#id_pet', function () {
        $('#search-frm').submit()
    });

    $(document).on('change', '#id_rent-type', function () {
        $('#search-frm').submit()
    });

    $(document).on('change', '#id_bed', function () {
        $('#search-frm').submit()
    });

    $(document).on('change', '#id_price_min', function () {
        $('#search-frm').submit()
    });

    $(document).on('change', '#id_price_max', function () {
        $('#search-frm').submit()
    });

    document.querySelector('#id_search_text').onkeyup = function (e) {
        if (e.keyCode === 13) {  // enter, return
            $('#search-frm').submit()
        }
    };

    $(document).on('change', '#id_near_check', function () {
        $('#search-frm').submit()
    });


</script>